# ðŸ“Š Elasticsearch Monitoring & Alerting Sanity Checks

This guide ensures your **monitoring stack correctly observes Elasticsearch health**.

---

## ðŸŽ¯ Objectives

- Detect node, shard, JVM, and disk issues early
- Ensure alerts fire **before outages**
- Validate monitoring pipeline correctness

---

## ðŸ“¡ 1. Node Availability

```bash
curl -u elastic https://es1:9200/_cat/nodes?v
```

âœ” Alert if:
- Node disappears
- Master changes frequently

---

## ðŸŸ¢ 2. Cluster Health Monitoring

```bash
curl -u elastic https://es1:9200/_cluster/health?pretty
```

ðŸ”” Alert if:
- `status != green`
- `unassigned_shards > 0`

---

## ðŸ§  3. JVM Heap Monitoring

```bash
curl -u elastic https://es1:9200/_nodes/stats/jvm?pretty
```

ðŸ”” Alert if:
- Heap usage > 75%
- Frequent GC pauses

---

## ðŸ’¾ 4. Disk Watermark Monitoring

```bash
curl -u elastic https://es1:9200/_nodes/stats/fs?pretty
```

ðŸ”” Alert if:
- Disk usage > 85%
- Writes blocked

---

## ðŸ”„ 5. Shard Allocation Monitoring

```bash
curl -u elastic https://es1:9200/_cat/shards?v
```

ðŸ”” Alert if:
- UNASSIGNED shards detected

---

## ðŸš¦ 6. Thread Pool Rejections

```bash
curl -u elastic https://es1:9200/_nodes/stats/thread_pool?pretty
```

ðŸ”” Alert if:
- `rejected` counters increase

---

## ðŸ§¯ 7. Log-Based Alerts

Monitor logs for:
- `OutOfMemoryError`
- `circuit_breaking_exception`
- `master not discovered`

---

## ðŸŸ¢ Monitoring Checklist

| Metric | Healthy |
|-----|-----|
| Node count stable | âœ… |
| Heap < 75% | âœ… |
| Disk < 85% | âœ… |
| Shards assigned | âœ… |
| No rejections | âœ… |

---
