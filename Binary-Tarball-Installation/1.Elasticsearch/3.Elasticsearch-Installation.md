# ðŸš€ Elasticsearch 9.2.3 Tarball Installation

This SOP describes **how to install Elasticsearch 9.2.3 using the binary tarball** and run it as a **systemd-managed service**.

> âš ï¸ Scope control  
> - âœ… Installation only  
> - âœ… systemd unit file  

---

## ðŸ§± Supported OS
- Ubuntu (20.04 / 22.04 / 24.04)
- RHEL / Rocky / Alma (8 / 9)

---

## ðŸ“Œ Version
- Elasticsearch: **9.2.3**
- Distribution: `linux-x86_64` tarball

---

## ðŸ“ Directory Layout

| Purpose | Path |
|------|------|
| Install | `/es/elasticsearch` |
| Config | `/es/elasticsearch/config` |
| Data | `/es/elasticsearch/data` |
| Logs | `/es/elasticsearch/logs` |

---

## ðŸ‘¤ Create Elasticsearch User

```bash
useradd --system --no-create-home --shell /usr/sbin/nologin elasticsearch
```

---

## ðŸ“¦ Download and Extract Tarball
Replace `9.2.3` with the Elasticsearch version number you want.
```bash
VERSION_NUMBER=9.2.3
```
```
cd ~/
wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-$VERSION_NUMBER-linux-x86_64.tar.gz
wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-$VERSION_NUMBER-linux-x86_64.tar.gz.sha512
shasum -a 512 -c elasticsearch-$VERSION_NUMBER-linux-x86_64.tar.gz.sha512
tar -xzf elasticsearch-$VERSION_NUMBER-linux-x86_64.tar.gz
```

---

## ðŸ“‚ Create Directories

```bash
mkdir /es && cd /es
mv ~/elasticsearch-$VERSION_NUMBER /es/
ln -s /es/elasticsearch-$VERSION_NUMBER /es/elasticsearch
mkdir /es/elasticsearch-$VERSION_NUMBER/data
chown -R elasticsearch:elasticsearch /es

```

---

## âš™ï¸ systemd Unit

```bash
cat > /etc/systemd/system/elasticsearch.service << 'EOF'
[Unit]
Description=Elasticsearch
Documentation=https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html
Wants=network-online.target
After=network-online.target

[Service]
Type=notify
# Environment variables (adjust paths if needed)
Environment=ES_HOME=/es/elasticsearch
Environment=ES_PATH_CONF=/es/elasticsearch/config
Environment=PID_DIR=/es/elasticsearch
Environment=ES_SD_NOTIFY=true

RuntimeDirectory=elasticsearch
RuntimeDirectoryMode=2755

WorkingDirectory=/es/elasticsearch

User=elasticsearch
Group=elasticsearch

# Limit settings (important for production)
LimitNOFILE=65535
LimitNPROC=4096
LimitAS=infinity
LimitFSIZE=infinity
# If using mlockall (bootstrap.memory_lock: true in elasticsearch.yml)
LimitMEMLOCK=infinity

ExecStart=/es/elasticsearch/bin/elasticsearch

# Restart on failure
Restart=on-failure
RestartSec=5

# Disable timeout (Elasticsearch startup can be slow)
TimeoutStopSec=0

# Proper shutdown handling
KillSignal=SIGTERM
KillMode=process
SendSIGKILL=no
SuccessExitStatus=143

StandardOutput=journal
StandardError=inherit

[Install]
WantedBy=multi-user.target

EOF
```

---

## ðŸ”„ Reload systemd

```bash
systemctl daemon-reload
```

## ðŸ” Enable on Boot

```bash
systemctl enable elasticsearch
```

---

## âœ… Done

Elasticsearch is installed via systemd.
